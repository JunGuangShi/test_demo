class Film{constructor(e,t,r){if(this.properties={element:e,width:r.width,height:r.height},t.forEach(function(t,i){this.unpreparedFrameCount=void 0!==this.unpreparedFrameCount?this.unpreparedFrameCount+t.frames.length:t.frames.length;let n={patch:t.patch,position:t.patch?t.position:void 0,startFrame:t.startFrame,endFrame:t.startFrame+t.frames.length-1,freezing:void 0!==t.freezing?t.freezing:{start:!1,end:!1},frames:[]};t.frames.forEach(function(e){let t=document.createElement("img");t.addEventListener("load",function(){this.unpreparedFrameCount=this.unpreparedFrameCount-1}.bind(this),{once:!0}),t.src=e,n.frames=n.frames.concat([t])}.bind(this)),this.layers=void 0!==this.layers?this.layers.concat([n]):[n];let s=document.createElement("canvas");s.height=r.height,s.width=r.width,s.style.width="100%",s.style.height="100%",s.style.objectFit="cover",0!==i&&(s.style.position="absolute",s.style.top="0",s.style.left="0",s.zIndex=i),document.getElementById(e).appendChild(s)}.bind(this)),document.getElementById(e).style.position="relative",document.getElementById(e).style.objectFit="cover",document.getElementById(e).style.overflow="hidden",r.loadFirstFrame){let e=function(){0===this.unpreparedFrameCount?this.requireFrame(0):(console.log(this.unpreparedFrameCount+" asset(s) are still not ready yet. Retry in 0.5s."),setTimeout(e,500))}.bind(this);e()}}requireFrame(e){e=Math.round(e),0===this.unpreparedFrameCount?(this.layers.forEach(function(t,r){e<t.startFrame?(this.currentFrame>=t.startFrame||void 0===this.currentFrame)&&(t.freezing.start?document.getElementById(this.properties.element).children[r].getContext("2d").drawImage(t.frames[0],t.patch?t.position.left:0,t.patch?t.position.top:0):document.getElementById(this.properties.element).children[r].getContext("2d").clearRect(0,0,this.properties.width,this.properties.height)):e>=t.startFrame&&e<=t.endFrame?document.getElementById(this.properties.element).children[r].getContext("2d").drawImage(t.frames[e-t.startFrame],t.patch?t.position.left:0,t.patch?t.position.top:0):(this.currentFrame<=t.endFrame||void 0===this.currentFrame)&&(t.freezing.end?document.getElementById(this.properties.element).children[r].getContext("2d").drawImage(t.frames[t.endFrame-t.startFrame],t.patch?t.position.left:0,t.patch?t.position.top:0):document.getElementById(this.properties.element).children[r].getContext("2d").clearRect(0,0,this.properties.width,this.properties.height))}.bind(this)),this.currentFrame=e):console.warn("Frame "+e+" is required, but "+this.unpreparedFrameCount+" assets are still loading in progress. Check connection if this continues.")}}
